load("@cgrindel_bazel_starlib//markdown:defs.bzl", "markdown_check_links_test")

filegroup(
    name = "all_doc_files",
    srcs = [
        "//:doc_files",
        "//bar:doc_files",
    ],
)

markdown_check_links_test(
    name = "check_links",
    size = "medium",
    # When run on a GitHub-hosted MacOS runner, the check for external links often fails with
    # ECONNRESET. This skips external link checks when executed there.
    config = select({
        "//:ci_on_macos": "@cgrindel_bazel_starlib//markdown:skip_external_link_checks_config",
        "//conditions:default": "@cgrindel_bazel_starlib//markdown:default_markdown_link_check_config",
    }),
    data = [":all_doc_files"],
    verbose = True,
)
